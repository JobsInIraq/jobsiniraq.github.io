---
# No layout inheritance - this is the base template
---

<!doctype html>
{%- comment -%}
  Include copyright notice (if _includes/copyright.html exists)
{%- endcomment -%}
{% include copyright.html %}

<html lang="{{ page.lang | default: site.lang | default: 'en' }}" 
      dir="{% if page.lang == 'ar' or page.lang == 'ku' %}rtl{% else %}ltr{% endif %}"
      class="no-js">

<head>
  {%- comment -%}
    Core theme head elements (meta tags, CSS, basic scripts)
    Defined in: _includes/head.html
  {%- endcomment -%}
  {% include head.html %}
  
  {%- comment -%}
    Custom head elements (performance scripts, GTM, meta tags)
    Defined in: _includes/head/custom.html
  {%- endcomment -%}
  {% include head/custom.html %}
</head>

<body class="layout--{{ page.layout | default: layout.layout }}{% if page.classes or layout.classes %}{{ page.classes | default: layout.classes | join: ' ' | prepend: ' ' }}{% endif %}"
      data-locale="{{ page.lang | default: site.lang | default: 'en' }}"
      data-rtl="{% if page.lang == 'ar' or page.lang == 'ku' %}true{% else %}false{% endif %}">

  {%- comment -%}
    GTM NoScript Fallback
    Loads when JavaScript is disabled
    GTM Container ID: GTM-KP6P96CF
  {%- endcomment -%}
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KP6P96CF"
            height="0" 
            width="0" 
            style="display:none;visibility:hidden"
            title="Google Tag Manager">
    </iframe>
  </noscript>

  {%- comment -%}
    Skip-to-content link for accessibility (WCAG 2.4.1)
    Allows keyboard users to bypass navigation
  {%- endcomment -%}
  {% include_cached skip-links.html %}
  
  {%- comment -%}
    Main site header/navigation
    Includes logo, menu, search toggle
    Translations loaded from YAML data files
  {%- endcomment -%}
  {% include_cached masthead.html %}

  {%- comment -%}
    Main content area
    This is where page/post content appears
  {%- endcomment -%}
  <div class="initial-content">
    {{ content }}
    
    {%- comment -%}
      Additional content after main content
      (e.g., newsletter signup, related posts)
      Only included if file exists
    {%- endcomment -%}
    {% include after-content.html %}
  </div>

  {%- comment -%}
    Site search overlay (if search is enabled)
    Only shown when site.search = true in _config.yml
  {%- endcomment -%}
  {% if site.search == true %}
    <div class="search-content">
      {% include_cached search/search_form.html %}
    </div>
  {% endif %}

  {%- comment -%}
    Site footer
    Includes copyright, links, custom footer content
  {%- endcomment -%}
  <div id="footer" class="page__footer">
    <footer>
      {%- comment -%}
        Custom footer content (if _includes/footer/custom.html exists)
      {%- endcomment -%}
      {% include footer/custom.html %}
      
      {%- comment -%}
        Main theme footer (copyright, social links)
      {%- endcomment -%}
      {% include_cached footer.html %}
    </footer>
  </div>

  {%- comment -%}
    JavaScript files (jQuery, theme scripts, custom scripts)
    Defined in: _includes/scripts.html
    Loaded at end of body for better performance
  {%- endcomment -%}
  {% include scripts.html %}

  {%- comment -%}
    Minimal Language Manager (lightweight, no data bloat)
    Only handles language switching - data comes from YAML
  {%- endcomment -%}
  <script>
    // Ultra-lightweight language manager (no translation data embedded)
    (function() {
      'use strict';
      
      const SUPPORTED_LANGS = ['en', 'ar', 'ku'];
      const RTL_LANGS = ['ar', 'ku'];
      const STORAGE_KEY = 'siteLanguage';
      
      function getSavedLanguage() {
        const saved = localStorage.getItem(STORAGE_KEY);
        return SUPPORTED_LANGS.includes(saved) ? saved : 'en';
      }
      
      function applyLanguage(lang) {
        if (!SUPPORTED_LANGS.includes(lang)) lang = 'en';
        
        // Update HTML attributes
        document.documentElement.setAttribute('lang', lang);
        const isRTL = RTL_LANGS.includes(lang);
        document.documentElement.setAttribute('dir', isRTL ? 'rtl' : 'ltr');
        document.body.setAttribute('data-locale', lang);
        document.body.setAttribute('data-rtl', isRTL ? 'true' : 'false');
        
        // Save preference
        localStorage.setItem(STORAGE_KEY, lang);
        
        // Broadcast to other components
        window.dispatchEvent(new CustomEvent('languageChanged', {
          detail: { language: lang, isRTL: isRTL }
        }));
      }
      
      // Initialize with saved language
      const savedLang = getSavedLanguage();
      applyLanguage(savedLang);
      
      // Expose to window
      window.languageManager = {
        setLanguage: applyLanguage,
        getLanguage: getSavedLanguage,
        supportedLanguages: SUPPORTED_LANGS
      };
    })();
  </script>

</body>
</html>